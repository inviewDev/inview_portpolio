const homepageList = [
  {
    url: "https://inviewdev.cafe24.com/skin-skin7/",
    img: "skin7",
    name: "템플릿01",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin9/",
    img: "skin9",
    name: "템플릿02",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin10/",
    img: "skin10",
    name: "템플릿03",
    category: "라이프서비스·의료·복지"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin11/",
    img: "skin11",
    name: "템플릿04",
    category: "쇼핑몰·제품 브랜드 (리빙·뷰티·소비재)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin13/",
    img: "skin13",
    name: "템플릿05",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin14/",
    img: "skin14",
    name: "템플릿06",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin5/",
    img: "skin5",
    name: "템플릿07",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin15/",
    img: "skin15",
    name: "템플릿08",
    category: "쇼핑몰·제품 브랜드 (리빙·뷰티·소비재)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin16/",
    img: "skin16",
    name: "템플릿09",
    category: "라이프서비스·의료·복지"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin17/",
    img: "skin17",
    name: "템플릿10",
    category: "쇼핑몰·제품 브랜드 (리빙·뷰티·소비재)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin19/",
    img: "skin19",
    name: "템플릿11",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin20/",
    img: "skin20",
    name: "템플릿12",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin21/",
    img: "skin21",
    name: "템플릿13",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin22/",
    img: "skin22",
    name: "템플릿14",
    category: "전문 서비스·B2B (교육·법률·IT·컨설팅)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin23/",
    img: "skin23",
    name: "템플릿15",
    category: "쇼핑몰·제품 브랜드 (리빙·뷰티·소비재)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin24/",
    img: "skin24",
    name: "템플릿16",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin25/",
    img: "skin25",
    name: "템플릿17",
    category: "기타 서비스"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin29/",
    img: "skin29",
    name: "템플릿18",
    category: "음식·외식·식품",
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin30/",
    img: "skin30",
    name: "템플릿19",
    category: "기타 서비스"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin31/",
    img: "skin31",
    name: "템플릿20",
    category: "라이프서비스·의료·복지"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin32/",
    img: "skin32",
    name: "템플릿21",
    category: "전문 서비스·B2B (교육·법률·IT·컨설팅)"
  },
  {
    url: "https://inviewdev.cafe24.com/skin-skin33/",
    img: "skin33",
    name: "템플릿22",
    category: "기타 서비스"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin18/",
    img: "skin18",
    name: "템플릿23",
    category: "전문 서비스·B2B (교육·법률·IT·컨설팅)"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin20",
    img: "skin20-1",
    name: "템플릿24",
    category: "라이프서비스·의료·복지"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin21",
    img: "skin21-1",
    name: "템플릿25",
    category: "건설·인테리어·설비·제조"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin22",
    img: "skin22-1",
    name: "템플릿26",
    category: "건설·인테리어·설비·제조"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin23",
    img: "skin23-1",
    name: "템플릿27",
    category: "건설·인테리어·설비·제조"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin24",
    img: "skin24-1",
    name: "템플릿28",
    category: "음식·외식·식품",
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin25",
    img: "skin25-1",
    name: "템플릿29",
    category: "라이프서비스·의료·복지"
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin26",
    img: "skin26",
    name: "템플릿30",
    category: "음식·외식·식품",
  },
  {
    url: "https://inview0310.cafe24.com/skin-skin27",
    img: "skin27",
    name: "템플릿31",
    category: "건설·인테리어·설비·제조"
  },
];

const categories = ['ALL', '라이프서비스·의료·복지', '전문 서비스·B2B (교육·법률·IT·컨설팅)', '음식·외식·식품', '건설·인테리어·설비·제조', '쇼핑몰·제품 브랜드 (리빙·뷰티·소비재)', '기타 서비스'];

const categoryCounts = {};
const filteredLists = {};
categories.forEach(cat => {
  filteredLists[cat] = homepageList.filter(item => !item.category || item.category.includes(cat) || cat === 'ALL');
  categoryCounts[cat] = filteredLists[cat].length;
});

function updateTabCounts() {
  categories.forEach(cat => {
    const countEls = document.querySelectorAll(`[data-tap-cont="${cat}"] + .count, a[data-tap-cont="${cat}"] .count`);
    countEls.forEach(countEl => {
      countEl.textContent = categoryCounts[cat];
    });
  });
}

function setList(pfFrame, category = 'ALL') {
  const list = filteredLists[category];
  pfFrame.innerHTML = list.map(item => `
    <li>
      <a href="${item.url}" target="_blank">
        <img src="./img/web_portpolio/${item.img}.webp" alt="${item.name}">
      </a>
      <a href="${item.url}" target="_blank" class="portpolioinfo">${item.name}</a>
    </li>
  `).join('');
}
function activateTab(targetCat) {
  const allBtns = document.querySelectorAll('.tap_btn_group a[data-tap-cont]');
  allBtns.forEach(btn => btn.classList.remove('active'));
  const targetBtn = document.querySelector(`a[data-tap-cont="${targetCat}"]`);
  if (targetBtn) targetBtn.classList.add('active');
  const tabSelect = document.querySelector('.tab_select');
  if (tabSelect) tabSelect.value = targetCat;
  const allConts = document.querySelectorAll('.tap_cont_group > div[data-tap-cont]');
  allConts.forEach(cont => cont.classList.remove('active'));
  const targetCont = document.querySelector(`div[data-tap-cont="${targetCat}"]`);
  if (targetCont) {
    targetCont.classList.add('active');
    const ul = targetCont.querySelector('ul.category-list');
    if (ul) setList(ul, targetCat);
  }
}

function initTabs() {
  const tabBtns = document.querySelectorAll('.tab_buttons a[data-tap-cont]');
  tabBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      activateTab(btn.dataset.tapCont);
    });
  });
}

function initResponsiveTabs() {
  const btnGroup = document.querySelector('.tap_btn_group');
  if (!btnGroup) return;

  const tabBtns = btnGroup.querySelector('.tab_buttons');
  const tabSelect = btnGroup.querySelector('.tab_select');

  function toggleTabMode() {
    const width = window.innerWidth;
    if (width <= 1024) {
      if (tabBtns) tabBtns.style.display = 'none';
      if (tabSelect) tabSelect.style.display = 'block';
    } else {
      if (tabBtns) tabBtns.style.display = 'flex';
      if (tabSelect) tabSelect.style.display = 'none';
    }
  }
  if (tabSelect) {
    tabSelect.addEventListener('change', (e) => {
      activateTab(e.target.value);
    });
  }
  toggleTabMode();
  let resizeTimeout;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(toggleTabMode, 100);
  });
}

document.addEventListener('DOMContentLoaded', () => {
  updateTabCounts();
  initTabs();
  initResponsiveTabs();
  const allUl = document.querySelector('.tap_cont_group [data-tap-cont="ALL"] ul.category-list');
  if (allUl) {
    setList(allUl, 'ALL');
  }
});